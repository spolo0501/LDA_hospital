# LDA 7個構面分析 - Google Colab 使用指南

## 📋 準備工作

### 1. 需要準備的檔案
- `LDA_7_topics_analysis.ipynb` - Jupyter Notebook 檔案（已生成）
- `combined_reviews.csv` - 資料檔案（位於 `processed_data/` 目錄）

## 🚀 使用步驟

### 方法一：使用 Google Drive（推薦）

#### 步驟 1: 上傳檔案到 Google Drive
1. 將 `combined_reviews.csv` 上傳到你的 Google Drive 根目錄
   - 或者創建資料夾（例如：`LDA_hospital/processed_data/`）然後上傳

#### 步驟 2: 開啟 Colab
1. 前往 [Google Colab](https://colab.research.google.com/)
2. 點選「檔案」→「上傳筆記本」
3. 選擇 `LDA_7_topics_analysis.ipynb`

#### 步驟 3: 執行分析
1. 依序執行每個 Cell（或使用「執行階段」→「全部執行」）
2. 當執行到「掛載 Google Drive」時，會要求授權
3. 在「方式 A」的 Cell 中，確認或修改資料檔案路徑：
   ```python
   # 如果檔案在 Google Drive 根目錄
   DATA_PATH = '/content/drive/MyDrive/combined_reviews.csv'

   # 如果檔案在子資料夾
   DATA_PATH = '/content/drive/MyDrive/LDA_hospital/processed_data/combined_reviews.csv'
   ```
4. 執行所有 Cell，等待分析完成

### 方法二：直接上傳檔案到 Colab

#### 步驟 1: 開啟 Colab
1. 前往 [Google Colab](https://colab.research.google.com/)
2. 上傳 `LDA_7_topics_analysis.ipynb`

#### 步驟 2: 上傳資料
1. 執行到「方式 B」的 Cell
2. 點選「選擇檔案」按鈕
3. 上傳 `combined_reviews.csv`

#### 步驟 3: 執行分析
1. 繼續執行後續的 Cell
2. 等待分析完成

## 📊 輸出結果

分析完成後會生成以下檔案：

1. **lda_k7_wordclouds.png** - 7個構面的文字雲視覺化
2. **lda_k7_distribution.png** - 構面評論數量分布圖
3. **lda_k7_rating_heatmap.png** - 構面與評分關係熱力圖
4. **lda_k7_analysis_results.xlsx** - 完整分析結果 Excel 檔案
   - 工作表1: 主題摘要（關鍵詞、評論數、佔比、平均評分）
   - 工作表2: 代表性評論（每個構面的高機率代表性評論）
   - 工作表3: 醫院主題分布（各醫院在不同構面的評論分布）
5. **lda_k7_lda_model.pkl** - 訓練完成的 LDA 模型檔案

## 💾 下載結果

執行最後一個 Cell 會自動下載所有生成的檔案到你的電腦。

或者手動下載：
1. 點選左側的「檔案」圖示
2. 找到生成的檔案
3. 右鍵點選 → 下載

## ⚠️ 注意事項

1. **執行時間**: 完整分析大約需要 5-15 分鐘（取決於資料量）
2. **中文字體**: Notebook 已設定好 Colab 的中文字體支援
3. **記憶體**: 如果資料很大，可能需要使用 Colab Pro（更多記憶體）
4. **工作階段**: Colab 免費版的工作階段會在 12 小時後自動關閉，記得下載結果

## 🔧 疑難排解

### 問題 1: 找不到資料檔案
- 檢查 `DATA_PATH` 路徑是否正確
- 確認 Google Drive 已成功掛載
- 可以在 Cell 中執行 `!ls /content/drive/MyDrive/` 查看檔案列表

### 問題 2: 中文顯示為方框
- Notebook 已設定 Noto Sans CJK 字體
- 如果還有問題，可以嘗試執行：
  ```python
  !apt-get install fonts-noto-cjk -y
  ```

### 問題 3: 記憶體不足
- 嘗試減少資料量
- 或升級到 Colab Pro

## 📧 需要協助？

如有任何問題，請檢查：
1. 資料檔案格式是否正確（需包含 `tokens_str` 欄位）
2. Python 套件是否安裝成功
3. Google Drive 路徑是否正確
